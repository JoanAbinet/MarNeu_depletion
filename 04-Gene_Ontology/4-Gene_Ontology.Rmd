---
title: "4-Gene Ontology"
author: "Joan Abinet"
date: "`r format (Sys.time(), format='%Y-%m-%d %H:%M:%S %z')`"
output:
  pdf_document:
    toc: true
    toc_depth: 2
  header-includes:
    -|
    ```{=latex}
    \usepackage{fvextra}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{
      breaksymbolleft={}, 
      showspaces = false,
      showtabs = false,
      breaklines,
      commandchars=\\\{\}
    }
    ```
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 65), tidy = TRUE)
```


\newpage

# Introduction

Gene Ontology (GO) enrichment analysis was performed using the web-based tool provided by the Gene Ontology Consortium (http://geneontology.org/) on 2025-06-25, using the GO database release from 2025-06-01. For each experimental condition, the top 30 differentially expressed genes ranked by their average log fold change were selected for GO analysis. Enrichment was assessed separately for each gene list, and results were obtained for the "Biological Process" category. Relevant enriched GO terms were visualized using the ggplot2 package. The gene ratio for each GO term was calculated as the number of enriched genes in the gene list divided by the total number of genes in a pathway.

# Loading packages
```{r}
suppressMessages({
  library(dplyr)
  library(Seurat)
  library(patchwork)
  library(ggplot2)
  library(formatR)
  library(xlsx)
  library(tidyverse)
})
```

# Gene ontology at Day 3

```{r}
# Loading gene geneontology.org
GO_D3 <- read.table("GO_treated_D3.txt", skip = 11, header = T, sep = "\t")
GO_D3 <- GO_D3[c(2,4,5,7,9),c(1:3,6,8)]
colnames(GO_D3) <- c("GO", "REF", "Count", "FoldEnrichment", "FDR")
GO_D3$`Gene ratio` <- GO_D3$Count/GO_D3$REF
GO_D3$GO <- str_sub(GO_D3$GO, 1, str_length(GO_D3$GO)-13)
GO_D3$GO <- fct_rev(factor(GO_D3$GO, levels = GO_D3$GO))

ggplot(GO_D3, aes(x = `Gene ratio`,y =GO, size = Count, color = FDR)) + geom_point() + ggtitle("Gene Onotology D3 Treated") + scale_color_gradient(limit = c(9.03e-9,0.05) ,low = "red", high = "blue") + theme_bw()+ scale_size(limit = c(2,6),range = c(3,10))
# ggsave("GO_J3_Treated.pdf", width = 8, height = 5)
```

# Gene ontology at day 14
```{r}
GO_D14 <- read.table("GO_treated_D14.txt", skip = 11, header = T, sep = "\t")
GO_D14 <- GO_D14[c(2,5,6,8,9,11,13,16),c(1:3,6,8)]
colnames(GO_D14) <- c("GO", "REF", "Count", "FoldEnrichment", "FDR")
GO_D14$`Gene ratio` <- GO_D14$Count/GO_D14$REF
GO_D14$GO <- str_sub(GO_D14$GO, 1, str_length(GO_D14$GO)-13)
GO_D14$GO <- fct_rev(factor(GO_D14$GO, levels = GO_D14$GO))

ggplot(GO_D14, aes(x = `Gene ratio`,y =GO, size = Count, color = FDR)) + geom_point() + ggtitle("Gene Onotology D14 Treated") + scale_color_gradient(limit = c(9.03e-9,0.05) ,low = "red", high = "blue") + theme_bw()+ scale_size(limit = c(2,6),range = c(3,10))
# ggsave("GO_J14_Treated.pdf", width = 8, height = 5)
```

# Gene ontology for PBS cells
```{r, fig.width= 12, fig.height=6}
GO_PBS <- read.table("GO_treated_D14_PBS.txt", skip = 11, header = T, sep = "\t")
GO_PBS <- GO_PBS[c(4,9,16,27,28,32,39),c(1:3,6,8)]
colnames(GO_PBS) <- c("GO", "REF", "Count", "FoldEnrichment", "FDR")
GO_PBS$`Gene ratio` <- GO_PBS$Count/GO_PBS$REF
GO_PBS$GO <- str_sub(GO_PBS$GO, 1, str_length(GO_PBS$GO)-13)
GO_PBS$GO <- fct_rev(factor(GO_PBS$GO, levels = GO_PBS$GO))

ggplot(GO_PBS, aes(x = `Gene ratio`,y =GO, size = Count, color = FDR)) + geom_point() + ggtitle("Gene Onotology D14 PBS") + scale_color_gradient(limit = c(1.03e-9,0.05) ,low = "red", high = "blue") + theme_bw()+ scale_size(limit = c(2,6),range = c(3,10))
# ggsave("GO_D14_PBS.pdf", width = 8, height = 5)
```

```{r}
sessionInfo()
```


